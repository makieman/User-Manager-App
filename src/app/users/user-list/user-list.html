<div class="container mx-auto p-4">
  <div class="flex justify-between items-center mb-4">
    <h1 class="text-2xl font-bold">Users</h1>
    <button
      class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"
      (click)="router.navigate(['/users/new'])"
    >
      Add User
    </button>
  </div>

  <div class="mb-4">
    <input type="text" placeholder="Search users..." class="w-full px-4 py-2 border rounded" (input)="onSearch($event)">
  </div>

  <div *ngIf="loading" class="flex justify-center items-center">
    <svg class="animate-spin h-8 w-8 text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
      <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
      <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
    </svg>
  </div>

  <div *ngIf="error" class="text-red-500 text-center">{{ error }}</div>

  <table *ngIf="!loading && !error" class="min-w-full bg-white shadow-md rounded">
    <thead>
      <tr class="bg-gray-200 text-gray-600 uppercase text-sm leading-normal">
        <th class="py-3 px-6 text-left">Name</th>
        <th class="py-3 px-6 text-left">Email</th>
        <th class="py-3 px-6 text-center">Role</th>
        <th class="py-3 px-6 text-center">Status</th>
        <th class="py-3 px-6 text-center">Actions</th>
      </tr>
    </thead>
    <tbody class="text-gray-600 text-sm font-light">
      <tr *ngFor="let u of paginatedUsers" class="border-b border-gray-200 hover:bg-gray-100">
        <td class="py-3 px-6 text-left whitespace-nowrap">{{ u.firstName }} {{ u.lastName }}</td>
        <td class="py-3 px-6 text-left">{{ u.email }}</td>
        <td class="py-3 px-6 text-center">{{ u.role }}</td>
        <td class="py-3 px-6 text-center">
          <span [ngClass]="u.active ? 'bg-green-200 text-green-600' : 'bg-red-200 text-red-600'" class="py-1 px-3 rounded-full text-xs">{{ u.active ? 'Active' : 'Inactive' }}</span>
        </td>
        <td class="py-3 px-6 text-center">
          <button (click)="viewUser(u.id)" class="text-blue-600 hover:text-blue-900 mr-2">View</button>
          <button (click)="editUser(u.id)" class="text-yellow-600 hover:text-yellow-900 mr-2">Edit</button>
          <button (click)="deleteUser(u.id)" class="text-red-600 hover:text-red-900">Delete</button>
        </td>
      </tr>
    </tbody>
  </table>

  <div *ngIf="!loading && !error" class="flex justify-between items-center mt-4">
    <div>
      <button (click)="previousPage()" [disabled]="currentPage === 1" class="px-4 py-2 border rounded disabled:opacity-50">Previous</button>
      <span class="px-4">Page {{ currentPage }} of {{ totalPages }}</span>
      <button (click)="nextPage()" [disabled]="currentPage === totalPages" class="px-4 py-2 border rounded disabled:opacity-50">Next</button>
    </div>
    <div>
      <span>Showing {{ (currentPage - 1) * pageSize + 1 }} - {{ currentPage * pageSize > filteredUsers.length ? filteredUsers.length : currentPage * pageSize }} of {{ filteredUsers.length }}</span>
    </div>
  </div>
</div>